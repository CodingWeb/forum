<?php

// Remplacer les accents !
function replace_accents($str)
{
    $str = htmlentities($str, ENT_COMPAT, "UTF-8");
    $str = preg_replace('/&([a-zA-Z])(uml|acute|grave|circ|tilde);/', '$1', $str);
    return html_entity_decode($str);
}

// Pour avoir une url propre !
function url_title($str)
{
    $str = str_replace(' ', '-', $str);
    return strtolower($str);
}

// vérifier si le pseudo n'ai pas deja pris

function check_pseudo($pseudo)
{
    require 'connect.php';
    $requete = $bdd->prepare('SELECT id FROM membres WHERE pseudo=:pseudo');
    $requete->bindValue(':pseudo',$pseudo,PDO::PARAM_STR);
    $requete->execute();
    if ($requete->rowCount()==0)
    {
        return true;
    }
    $requete->closeCursor();
}

// vérifie si le champ email est deja pris
function check_emails($emails)
{
    require 'connect.php';
    $requete = $bdd->prepare('SELECT id FROM membres WHERE email=:emails');
    $requete->bindValue(':emails',$emails,PDO::PARAM_STR);
    $requete->execute();
    if ($requete->rowCount()==0)
    {
        return true;
    }
    $requete->closeCursor();
}


// Ajouter un membre dans la basse de donnée

function add_membre($pseudo,$emails,$pass)
{
    require 'connect.php';
    $requete = $bdd->prepare('INSERT INTO membres (pseudo, email, pass) VALUES (:pseudo,:email,:pass)');
    $requete->bindValue(':pseudo',$pseudo,PDO::PARAM_STR);
    $requete->bindValue(':email',$emails,PDO::PARAM_STR);
    $requete->bindValue(':pass',sha1($pass),PDO::PARAM_STR);
    $requete->execute();
    $requete->closeCursor();
}

// Ajouter un formulaire de connexion

function check_id($pseudo,$pass)
{
    require 'connect.php';
    $requete = $bdd->prepare('SELECT id FROM membres WHERE pseudo=:pseudo AND pass=:pass');
    $requete->bindValue(':pseudo', $pseudo, PDO::PARAM_STR);
    $requete->bindValue(':pass', sha1($pass), PDO::PARAM_STR);
    $requete->execute();
    if ($requete->rowCount() > 0) {
        return true;
    }
    $requete->closeCursor();
}

// les sessions

function check_session()
{
    if (!empty($_SESSION['membre']))
    {
        return true;
    }
}